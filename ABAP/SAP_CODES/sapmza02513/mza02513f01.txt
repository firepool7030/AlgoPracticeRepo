*&---------------------------------------------------------------------*
*&  Include           MZB00511F01
*&---------------------------------------------------------------------*
*&---------------------------------------------------------------------*
*&      Form  GET_INFO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_info .
  CLEAR: zsb002012, zsb002013.
  "조건 사원명 취득
  PERFORM get_emp_name.

  "사원 정보
  PERFORM get_emp_info.

  "부서 정보
  IF zsb002012-orgeh IS NOT INITIAL.
    PERFORM get_orgeh_info.
  ENDIF.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_EMP_INFO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_emp_info .
  CLEAR zsb002012.
  "사원 정보 취득
  SELECT SINGLE pernr lname fname entdt gesch orgeh money waers
    FROM ztb0001
    INTO CORRESPONDING FIELDS OF zsb002012
   WHERE pernr = zsb002011-pernr.
  IF sy-subrc <> 0.
*     MESSAGE
    RETURN.
  ENDIF.
  " 사원명 취득
  PERFORM concate_emp_name.
  " 성별 Radio
  PERFORM set_gesch_radio.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  CONCATE_EMP_NAME
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM concate_emp_name .
  CLEAR zsb002012-ename.
  CONCATENATE zsb002012-lname zsb002012-fname
  INTO zsb002012-ename.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_GESCH_RADIO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM set_gesch_radio .
  CLEAR: zsb002012-gesch_m, zsb002012-gesch_f.
  CASE zsb002012-gesch.
    WHEN '1'.
      zsb002012-gesch_m = 'X'.
    WHEN '2'.
      zsb002012-gesch_f = 'X'.
  ENDCASE.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_ORGEH_INFO
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_orgeh_info .
  CLEAR zsb002013.
  "부서 정보 취득
  SELECT SINGLE depid phone dflag
    FROM ztb0002
    INTO CORRESPONDING FIELDS OF zsb002013
   WHERE depid = zsb002012-orgeh.
  IF sy-subrc <> 0.
*     MESSAGE
    RETURN.
  ENDIF.
  "부서명 취득
  PERFORM get_orgeh_name.

  "부서 폐지(Check Box)
  PERFORM set_orgeh_dflag_checkbox.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_ORGEH_NAME
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_orgeh_name .
  "부서명 취득
  CLEAR zsb002013-dname.
  SELECT SINGLE dname
    FROM ztb0002_t
    INTO zsb002013-dname
   WHERE depid = zsb002012-orgeh
     AND langu = sy-langu.

ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  SET_ORGEH_DFLAG_CHECKBOX
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM set_orgeh_dflag_checkbox .
  CLEAR zsb002013-dflag_c.
  IF zsb002013-dflag = 'Y'.
    zsb002013-dflag_c = 'X'.
  ENDIF.
ENDFORM.
*&---------------------------------------------------------------------*
*&      Form  GET_EMP_NAME
*&---------------------------------------------------------------------*
*       text
*----------------------------------------------------------------------*
*  -->  p1        text
*  <--  p2        text
*----------------------------------------------------------------------*
FORM get_emp_name .
  CLEAR: zsb002011-ename, zsb002011-fname, zsb002011-lname.
  "사원 정보 취득
  SELECT SINGLE lname fname
    FROM ztb0001
    INTO (zsb002011-lname, zsb002011-fname )
   WHERE pernr = zsb002011-pernr.
  IF sy-subrc <> 0.
*     MESSAGE
    RETURN.
  ENDIF.

  " 사원명 취득
  zsb002011-ename = zsb002011-lname && zsb002011-fname.
  PERFORM concate_emp_name. "USING ... CHANGING ...
ENDFORM.

----------------------------------------------------------------------------------
Extracted by Mass Download version 1.4.6 - E.G.Mellodew. 1998-2025. Sap Release 750
